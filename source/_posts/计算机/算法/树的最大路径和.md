---
title: 树的最大路径和
categories:
  - 计算机
  - 算法
tags:
  - 树
mathjax: true
abbrlink: 49292
date: 2022-08-29 20:21:35
---
## 叶子到根
```
   10
  /  \
 -2   7
 /\
8 -4 
```
最大路径和为 $10+7=17$.

<!--more-->

### Bottom Up
```py
def maxPathSum(root):
    if root is None:
        return -float('inf')
    if root.left is None and root.right is None:
        return root.val

    left = maxPathSum(root.left)
    right = maxPathSum(root.right)
    return max(left, right) + root.val
```

### Top Down
```py
class Solution:
    def maxPathSum(self, root):
        self.ret = -float('inf')
        self.helper(root, 0)
        return self.ret
    
    def helper(self, root, curSum):
        if root is None:
            return
        if root.left is None and root.right is None:
            self.ret = max(self.ret, curSum + root.val)
            return
        self.helper(root.left, curSum + root.val)
        self.helper(root.right, curSum + root.val)
```

## 叶子到根或部分
```
   -10
   /  \
  2   11
     /  \
    6   14
         \
          -1
```
最大路径和为 $11+14=25$.

### Top Down
```py
class Solution:
    def maxPath(self, root):
        if root is None:
            return 0
        self.result = root.val
        self.helper(root, 0)
        return self.result

    def helper(self, root, prev):
        if root is None:
            return
        prev = max(root.val, prev + root.val)
        self.result = max(self.result, prev)
        self.helper(root.left, prev)
        self.helper(root.right, prev)
```

## 叶子到叶子
```py
class Solution:
    def maxPathSum(self, root):
        self.result = -float('inf')
        self.helper(root)
        return self.result

    def helper(self, root):
        if root is None:
            return 0
        if root.left is None and root.right is None:
            return root.val

        left = self.helper(root.left)
        right = self.helper(root.right)

        if root.left and root.right:
            self.result = max(self.result, left + right + root.val)
            return max(left, right) + root.val

        else:
            if root.left is None and root.right:
                return right + root.val
            elif root.left and root.right is None:
                return left + root.val
```

## 任意两个节点

```py
class Solution:
    def find_max(self, root):
        self.max = -float('inf')
        self.helper(root)
        return self.max

    def helper(self, root):
        if root is None:
            return 0
        left = self.helper(root.left)
        right = self.helper(root.right)
        self.max = max(self.max, root.val + max(left, 0) + max(right, 0))
        return max(left, right, 0) + root.val
```