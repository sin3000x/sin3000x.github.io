---
title: 条件性和稳定性
date: '2023-04-09 12:34'
mathjax: true
categories:
  - 数学
  - 数值分析
tags:
  - 数值线性代数
  - 条件数
  - 误差分析
abbrlink: 37593
---
Conditioning 指受到扰动后**问题**的表现。Stability 指受到扰动后**算法**的表现。

<!--more-->

## Conditioning
### 一个例子
考虑两个矩阵$$\begin{bmatrix} 1 & 1000  \\ \boxed{0} & 1\end{bmatrix},\quad\begin{bmatrix}1 & 1000  \\  \boxed{0.001} & 1\end{bmatrix},$$它们只在左下角有微小的差别，但是它们的特征值分别是 $\{1,1\}$ 和 $\{0,2\}$。计算非对称矩阵的特征值就是一个典型的 ill-conditioned 问题，相比之下对于对称矩阵（更广义地：正规矩阵）而言，问题就是 well-conditioned 的。条件数（condition number）可以量化这种扰动带来的影响，条件数越大，问题的解越容易受扰动的影响，条件性越差。

### 一般的定义
我们可以给出条件数的严格定义。假设 $x$ 是一个问题数据，而 $f(x)$ 是对应问题的解。记 $\Delta x$ 是 $x$ 的一个微小扰动，而 $\Delta f=f(x+\Delta x)-f(x)$ 是 $f$ 的微小扰动（我们默认 $f$ 是连续的：这是现实中的通常情况）。那么 $f$ 在 $x$ 处的**【绝对条件数】**被定义为$$\boxed{\hat\kappa=\sup_{\Delta x}{\lVert\Delta f\rVert\over \lVert\Delta x\rVert}},$$也就是**一个最差的微扰能带来的解的变化率**。把式子中的绝对变化值变成相对变化值，就可以得到**【相对条件数】**的定义：$$\boxed{\kappa=\sup_{\Delta x}\frac{\lVert\Delta f\rVert / \lVert f(x)\rVert}{\lVert \Delta x\rVert / \lVert x\rVert}}.$$不加说明的“条件数”指相对条件数。

### 对于矩阵

矩阵-向量乘法的条件数是多少呢？假设 $A$ 是固定的，给定问题数据 $x$，问题的解是 $Ax$。那么根据定义，$$
\kappa=\sup_{\Delta x}\frac{\lVert A\Delta x\rVert / \lVert Ax\rVert}{\lVert\Delta x\rVert / \lVert x\rVert}=\lVert A\rVert\frac{\lVert x\rVert}{\lVert Ax\rVert},
$$其中用到了 $\lVert A\rVert$ 的定义。可以利用放缩$$\lVert x\rVert=\lVert A^{-1}Ax\rVert\leq\lVert A^{-1}\rVert\cdot\lVert Ax\rVert$$得出$$\kappa\leq\lVert A\rVert\cdot\lVert A^{-1}\rVert.$$如果问题变成了给定 $A$ 和 $b$，要解出 $Ax=b$ 中的 $x=A^{-1}b$，结论是一样的：把上文中的  $A$ 和 $x$ 换成 $A^{-1}$ 和 $b$，也可以得到这个问题的条件数$$\kappa\leq \lVert A\rVert\cdot\lVert A^{-1}\rVert.$$这个上界十分重要，以至于我们直接把它定义为**【矩阵的条件数】**：$$\boxed{\kappa(A)=\lVert A\rVert\cdot\lVert A^{-1}\rVert}.$$如果特殊地取 2-范数，那么$$\kappa_2(A)={\sigma_\max(A)\over\sigma_\min(A)}.$$一个奇异矩阵的条件数是无穷大，可见条件数可以衡量一个矩阵的奇异程度。

在上文中我们证明了固定 $A$，扰动 $b$ 求解 $x=A^{-1}b$ 的条件数是 $\kappa(A)$ （我们只证明了它是上界，但使得这个上界达到的扰动是存在的）。实际上也可以证明固定 $b$，扰动 $A$ 求解 $x$ 的条件数也是 $\kappa(A)$。

## Stability

和上一节一样，我们记 $x$ 是一个问题数据，$f(x)$ 是它的真实解。计算机算法难免会有精度上的误差，记这个问题的计算结果是 $\tilde f(x)$ 。那么计算的**【相对误差】**就是$$\frac{\lVert \tilde f(x)-f(x)\rVert}{\lVert f(x)\rVert}.$$
注意，这里的误差并不能看出算法的可靠程度：如果问题本身的条件数很大，喂给计算机的 $x$ 本身就有微扰，会带来结果的很大变化。

所以我们定义一个算法是**【稳定的】**，如果对于任意的问题数据 $x$，都存在着一个 $x$ 附近的 $\tilde x$，使得 
$x$ 的计算解对于 $\tilde x$ 的真实解的相对误差
$$\begin{equation}\frac{\lVert\tilde f(x)-f(\tilde x)\rVert}{\lVert f(\tilde x)\rVert}\label{eq:relerr}\end{equation}$$很小。这里的“附近”、“很小”都是相对于计算机精度而言的。换句话说：$$\boxed{\text{一个稳定的算法，给出 nearly right 问题的 nearly right 解。}}$$
一个更强的条件是后向稳定性（backward stability），它限制相对误差 $\eqref{eq:relerr}$ 为 0。一个算法是**【后向稳定的】**，如果对于所有 $x$，都存在一个 $x$ 附近的 $\tilde x$，使得 $x$ 的计算解恰好是 $\tilde x$ 的真实解。换句话说：$$\boxed{\text{一个后向稳定的算法，给出 nearly right 问题的 exactly right 解。}}$$

### 结论

研究条件数和稳定性的最重要结论：**后向稳定 + 小条件数 = 精确解**。

|如果算法 $\tilde f$ 是后向稳定的，那么相对误差$$\frac{\lVert\tilde f(x)-f(x)\rVert}{\lVert f(x)\rVert}=\kappa\varepsilon.$$|
|---|
|因为 $\tilde f$ 是后向稳定的，所以存在一个 $\tilde x$ 在 $x$ 附近：$$\lVert \tilde x-x\rVert=\varepsilon\lVert x\rVert,$$且 $\tilde f(x)=f(\tilde x)$。于是$$\frac{\lVert\tilde f(x)-f(x)\rVert}{\lVert f(x)\rVert}=\frac{\lVert f(\tilde x)-f(x)\rVert}{\lVert f(x)\rVert}\leq\kappa\varepsilon.$$|

### 例子

稳定的算法：

- 计算浮点数之间的加减乘除（后向稳定）
- 计算两个向量的内积、矩阵-向量乘法（后向稳定）
- 计算两个向量的外积（后向不稳定）
- 计算 $\sin x$，$\cos x$（后向不稳定）
- 解三角型方程组（后向稳定）
- 计算正定矩阵的 Cholesky 分解（后向稳定）
- 正交矩阵和其他矩阵的乘法（后向稳定）
- QR 分解的 Householder 算法（后向稳定）
- SVD 分解的 Golub-Kahan 算法

不稳定的算法：

- 用解特征方程的方法来计算特征值（给系数求方程根的问题是 ill-conditioned 的）
- 计算非对称（非正规）矩阵的特征值分解、Jordan 标准型