---
title: 卡方检验
categories:
  - 数学
  - 统计
mathjax: true
abbrlink: 7261
date: 2022-09-04 09:29:53
---
原假设: 两个 (binary) 变量独立.

|       | $Y=0$        | $Y=1$      |        total          |
|-------|------------|------------|------------------|
| $Z=0$   | $X_{00}$     | $X_{01}$     | $X_{0\cdot}$       |
| $Z=1$   | $X_{10}$     | $X_{11}$     | $X_{1\cdot}$       |
| total | $X_{\cdot0}$ | $X_{\cdot1}$ | $X_{\cdot\cdot}=n$ |

$$
U = \sum_{i=0}^1\sum_{j=0}^1\frac{(X_{ij}-E_{ij})^2}{E_{ij}},
$$
其中
$$
E_{ij}=\frac{X_{i\cdot}X_{\cdot j}}{n}
$$
含义是原假设下该单元格的期望值.

在原假设下, $U\sim \chi_1^2$. 其中自由度为 $(I-1)(J-1)$.

```py
from scipy.stats import chi2_contingency

table = [[90, 165], [84, 307]]
U, p, dof, expected = chi2_contingency(table, correction=False)
```

```
U = 14.95864355957614
p = 0.00010989348314654599
dof = 1
expected = [[ 68.68421053 186.31578947]
            [105.31578947 285.68421053]]
```