---
title: 投影
categories:
  - 数学
  - 线性代数
mathjax: true
abbrlink: 50690
date: 2023-04-01 20:02:53
---

投影（projector）是一个幂等（idempotent）方阵：
$$
P^2=P.
$$
<!--more-->

## 解释

为什么管 $P$ 叫投影呢？我们想一个现实的场景：阳光从天上照下来，把大家都投影到地面上，让大家都有了地面上的影子。$P$ 就像是阳光，把向量 $v$ 投影到 $P$ 的值域 $\text{range}(P)$ 里（也就是此时的地面），结果 $Pv$ 就是 $v$ 在地面上的影子。
![一个投影的作用，和平面上一个点的影子。](/file/gif/Proj.gif)


之后我们会解释它为什么是不满秩的。

那为什么要求 $P$ 幂等呢？不是任何矩阵都可以做到吗？这就是“影子”的性质了。如果地面上已经有影子了，它的影子是谁？是它自己嘛！假设 $v$ 已经在 $P$  的值域中，我们不妨写作 $v=Px$，于是根据 $P$ 的性质：
$$
Pv=P(Px)=P^2x=Px=v.
$$
这就是说，$v$ 的影子还是 $v$。只有 $P$ 满足了幂等性质，才会使得“影子的影子是自己”。换句话说，投影多少遍的效果和投影一遍的效果是一样的。上面的图中，实际上投影作用了两次，只不过第二次什么也没有发生。

我们看一下一般的奇异矩阵作用两次的效果：![第二次作用时，影子移动了。这就不符合影子的性质了。](/file/gif/NotProj.gif)

这里第二次作用后值域没变是个巧合，它是一维矩阵的特殊性质。

## 补投影与直和分解

如果 $P$ 是幂等的，那么 $I-P$ （被称为 complementary projector）也是幂等的：
$$
(I-P)^2=I-2P+P^2=I-2P+P=I-P.
$$
它投向的子空间是 $P$ 的核（怎么证明？用互相包含）：
$$
\text{range}(I-P)=\text{null}(P).
$$
我们也可以对称地得到
$$
\text{null}(I-P)=\text{range}(P).
$$
可以容易地验证
$$
\text{range}(P)\cap\text{null}(P)=\{0\},
$$
这表明一个投影的核和像构成了全空间的直和。反之也是成立的（后面给出一个构造性的证明）：假设
$$
\C^n=X\oplus Y,
$$
那么就存在一个投影 $P$ 使得 $X=\text{range}(P)$，并且 $Y=\text{null}(P)$。我们把 $P$ 叫做**沿 $Y$ 至 $X$ 的投影**。给定 $v\in\C^n$，那么 $Pv$ 位于 $X$ 中，$(I-P)v$ 位于 $Y$ 中。

## 正交投影

正交投影指的是上文中 $X\perp Y$ 的情况。**正交投影指的不是 $P$ 是正交矩阵！**反而，它指的是 $P$ 对称。



{% gp 2-2 %}
![](/file/gif/Proj.gif)
![](/file/gif/ComplementProj.gif)
{% endgp %}
<p class="image-caption">一个正交投影和它的补投影。可见它们的值域构成了平面的正交直和分解。</p>


| 定理：$P$ 是正交投影 $\iff$ $P$ 是 Hermitian（实数域中对阵）的。 |
| ------------------------------------------------------------ |
| $(\Longleftarrow)$ 假设 $P=P^*$，我们要证 $\range(P)$ 中的 $Px$ 和 $\null(P)$ 中的 $(I-P)y$ 是正交的。这个简单，直接验证$$(Px)^*(I-P)y=x^*P^*(I-P)y=x^*(P-P^2)y=0.$$
$(\Longrightarrow)$ 假设 $m$ 阶方阵 $P$ 是沿着 $Y$ 到 $X$ 的投影，其中 $X$ 是 $n$ 维空间，且 $X$ 与 $Y$ 正交。注意其中 $X=\range(P)$，$Y=\null(P)$。记全空间的一组正交基 $\{q_1,\ldots,q_m\}$ 中的 $\{q_1,\ldots,q_n\}$ 是 $X$ 的基，$\{q_{n+1},\ldots,q_m\}$ 是 $Y$ 的基。由于 $X$ 的基都在 $P$ 的值域中，对其中的 $q_i$ 有 $Pq_i=q_i$（“影子”的性质）。而 $Y$ 的基都在 $P$ 的核中，相应地有 $Pq_i=0$。<br />记 $Q=[q_1,\ldots,q_m]$，就有 $PQ=[q_1,\ldots,q_n,0,\ldots,0]$。于是$$Q^*PQ=\begin{bmatrix}1 &&&\\&\ddots&&&\\&&1&&\\&&&0&\\&&&&\ddots\end{bmatrix}=:\Sigma$$是一个对角阵，那么 $P=Q\Sigma Q^*$ 就是 Hermitian 的。|
|*注 1：这个方法实际上构造了 $P$ 的 SVD 分解。*|
|*注 2：这说明了满秩的投影矩阵只能是单位阵：$P=QQ^*=I$。一般地，投影矩阵都是奇异阵。*|


## 标准正交基

在上文中我们得到了一个正交投影的 SVD 分解：$$P=Q\Sigma Q^*=Q\begin{bmatrix}1 &&&\\&\ddots&&&\\&&1&&\\&&&0&\\&&&&\ddots\end{bmatrix}Q^*,$$我们可以自然地略去那些 0 奇异值：$$\begin{equation}\label{orthonormal}\boxed{P=\tilde Q\tilde Q^*}\end{equation},$$其中 $\tilde Q$ 是 $Q$ 的前 $\rank(P)$ 列组成的，它的列是单位正交的（此时称 $\tilde Q$ 是 orthonormal 的）。

只要任给一个 orthonormal 的矩阵 $\tilde Q^*$，总可以构成一个正交投影 $\tilde Q\tilde Q^*$，它将所有向量投到 $\range(\tilde Q)$ 中。而它的补投影 $I-\tilde Q\tilde Q^*$ 也是一个正交投影（证明：它是 Hermitian 的），投至的空间正交于 $\range(\tilde Q)$。

一个特殊情况是 $\tilde Q$ 是（单位化的）列向量 $q$，此时两个投影就是$$P_q=qq^{*},\quad P_{\perp q}=I-qq^*.$$它们在 Householder reflection 中起到了重要作用。

## 一般基

假设 $\{a_1,\ldots,a_n\}$ 是一个子空间的基，但不一定标准正交。记它们组成了矩阵 $A\in\C^{m\times n}$，那么投入该子空间的正交投影是$$\boxed{P=A(A^*A)^{-1}A^*}.$$怎么得到的呢？

设 $v$ 是空间中的向量，那么正交投影后的 $Pv$ 在 $\range(A)$ 中，剩下的分量 $v-Pv$ 正交于 $\range(A)$：$$A^*(v-Pv)=0.$$记影子 $Pv=Ax$（因为它在 $A$ 的值域中），那么有$$A^{*}(v-Ax)=0\implies x=(A^*A)^{-1}A^*v,$$对比 $Ax=Pv$ 便得到了 $P=A(A^*A)^{-1}A^*$。注意当 $A$ 的各列标准正交时，就退化成了 $\eqref{orthonormal}$。